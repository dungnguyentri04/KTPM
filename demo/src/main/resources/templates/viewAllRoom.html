<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
	  th:replace="~{base::layout(~{::content})}">

<div class="container" th:fragment="content">
	<div class="page-inner">
		<div class="row">
			<div class="col-md-12">
				<div class="card">
					<div class="card-header">
						<div class="d-flex align-items-center">
							<h4 class="card-title">View Rooms</h4>
							<a class="btn btn-primary btn-round ms-auto" th:href="@{/addRoom}">
								<i class="fa fa-plus"></i>
								Add Row
							</a>
						</div>
					</div>
					<div class="card-body">
						<!-- Modal -->

						<div class="table-responsive">
							<table id="add-row" class="display table table-striped table-hover">
								<thead>
								<tr>
									<th>Name</th>
									<th>Owner Name</th>
									<th>Status</th>
									<th style="width: 10%">Action</th>
								</tr>
								</thead>

								<tbody id="allRooms">


								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
		<div class="modal-dialog modal-dialog-centered">
			<div class="modal-content">
				<div class="modal-header border-0 pb-0">
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body text-center pt-0">
					<div class="mb-3">
						<i class="fas fa-exclamation-triangle text-warning" style="font-size: 3rem;"></i>
					</div>
					<h5 class="modal-title mb-3" id="deleteModalLabel">Xác nhận xóa</h5>
					<p class="mb-0">Bạn có chắc chắn muốn xóa phòng không?</p>
					<p class="text-muted small">Hành động này không thể hoàn tác.</p>
				</div>
				<div class="modal-footer border-0 justify-content-center">
					<button type="button" class="btn btn-secondary px-4" data-bs-dismiss="modal">Hủy</button>
					<button type="button" class="btn btn-danger px-4" id="confirmDeleteBtn">Xóa</button>
				</div>
			</div>
		</div>
	</div>

	<script>
		fetch("api/rooms")
			.then(response => {
				const data = response.json();
				if (response.ok) {
					return data;
				} else {
					throw new Error('Error: ' + data.message);
				}
			})
			.then(res => {
				const data = res.data;
				const allRooms = document.getElementById("allRooms");
				data.forEach(room => {
					const row = document.createElement("tr");
					row.innerHTML = `
						<td>${room.name}</td>
						<td>${room.ownerName}</td>
						<td>${room.status}</td>
						<td>
					  <div class="form-button-action">
						<a type="button" class="btn btn-link btn-primary btn-lg"
							 title="Chỉnh sửa" data-original-title="Edit Task">
						  <i class="fa fa-edit"></i>
						</a>
						<button type="button" class="btn btn-link btn-danger"
								data-bs-toggle="modal" title="Xóa" data-original-title="Remove"
								data-user-id="${room.id}"
								data-bs-target="#deleteModal" data-room-name="${room.name}">
						  <i class="fa fa-times"></i>
						</button>
					  </div>
					</td>`;
					allRooms.appendChild(row);
				})
			})
			.catch(error => {
				console.error(error);
				alert("Lỗi: " + error.message);
			});

	</script>

</div>

